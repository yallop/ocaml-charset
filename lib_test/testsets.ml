(*
 * Copyright (c) 2022 Jeremy Yallop.
 *
 * This file is distributed under the terms of the MIT License.
 * See the file LICENSE for details.
 *)

let char_sets =
  [['\000'; '\214'];
   [];
   ['\000'; '\001'; '\002'; '\003'; '\004'; '\006'];
   ['\001'; '\002'; '\003'; '\004'; '\006'; '>'; '?'; '@'; '\127'; '\199'];
   ['\214'];
   ['\255'];
   ['\254'; '\255'];
   ['\000'; '\001'; '\255'];
   ['\012'; '\015'; ','; '='; 'K'; 'R'; 'v'; 'y'; '\134'; '\147'; '\156';
    '\187'; '\194'; '\196'; '\207'; '\243'];
   ['\001'; '\022'; '\027'; '!'; '#'; ')'; '.'; '2'; '3'; 'N'; 'X'; 'c'; 'd';
    'v'; 'z'; '\128'; '\133'; '\146'; '\156'; '\162'; '\165'; '\167'; '\168';
    '\182'; '\196'; '\197'; '\203'; '\208'; '\215'; '\226'; '\233'; '\241'];
   ['\002'; '\004'; '\007'; '\t'; '\014'; '\018'; ' '; '+'; '1'; '7'; '9';
    ':'; '<'; 'S'; 'Y'; '\\'; 'a'; 'e'; 'u'; '\132'; '\133'; '\152'; '\155';
    '\156'; '\158'; '\162'; '\179'; '\182'; '\186'; '\191'; '\193'; '\196';
    '\198'; '\205'; '\210'; '\215'; '\228'; '\233'; '\242'; '\247'; '\248';
    '\251'];
   ['\000'; '\001'; '\n'; '\015'; '\022'; '\028'; ' '; '"'; '&'; ','; '2';
    ':'; ';'; 'C'; 'G'; 'N'; 'T'; '['; 'd'; 'e'; 'h'; 'n'; 't'; 'y'; '}';
    '\129'; '\130'; '\134'; '\136'; '\137'; '\138'; '\139'; '\142'; '\143';
    '\146'; '\162'; '\163'; '\166'; '\168'; '\180'; '\184'; '\185'; '\188';
    '\196'; '\201'; '\203'; '\207'; '\217'; '\219'; '\230'; '\231'; '\241';
    '\242'; '\243'; '\244'; '\253'; '\255'];
   ['\001'; '\005'; '\006'; '\t'; '\011'; '\014'; '\015'; '\019'; '\028';
    ' '; '"'; '$'; '\''; '('; '+'; '0'; '8'; '='; 'A'; 'E'; 'H'; 'J'; 'M';
    'N'; 'P'; 'Q'; 'T'; 'U'; 'Z'; 'c'; 'k'; 's'; '|'; '}'; '\133'; '\142';
    '\147'; '\149'; '\154'; '\157'; '\162'; '\164'; '\165'; '\166'; '\168';
    '\174'; '\175'; '\177'; '\181'; '\189'; '\191'; '\192'; '\193'; '\194';
    '\195'; '\200'; '\202'; '\203'; '\204'; '\208'; '\212'; '\224'; '\225';
    '\226'; '\229'; '\230'; '\242'; '\249'; '\254'];
   ['\007'; '\012'; '\r'; '\015'; '\019'; '\020'; '\023'; '\026'; '\027';
    '\029'; '!'; '#'; '\''; '('; ')'; '+'; ','; '/'; '5'; '6'; '7'; '8'; '9';
    '?'; 'A'; 'C'; 'E'; 'H'; 'K'; 'M'; 'O'; 'S'; 'V'; 'X'; 'Z'; 'a'; 'g';
    'h'; 'm'; 'x'; '{'; '\129'; '\131'; '\134'; '\138'; '\140'; '\145';
    '\155'; '\160'; '\162'; '\171'; '\173'; '\177'; '\180'; '\181'; '\185';
    '\192'; '\193'; '\196'; '\197'; '\200'; '\201'; '\204'; '\209'; '\210';
    '\214'; '\216'; '\224'; '\227'; '\230'; '\232'; '\237'; '\238'; '\243';
    '\247'; '\248'; '\254'];
   ['\002'; '\005'; '\006'; '\007'; '\015'; '\017'; '\021'; '\023'; '"'; '#';
    ')'; '*'; '+'; ','; '.'; '/'; '2'; '5'; '7'; '<'; '>'; '?'; 'A'; 'E';
    'K'; 'R'; 'T'; 'U'; 'V'; 'W'; 'X'; 'Y'; '\\'; '`'; 'a'; 'c'; 'd'; 'f';
    'g'; 'h'; 'n'; 't'; 'u'; 'z'; '~'; '\128'; '\129'; '\130'; '\133';
    '\140'; '\141'; '\144'; '\145'; '\151'; '\154'; '\155'; '\158'; '\164';
    '\165'; '\167'; '\170'; '\172'; '\173'; '\174'; '\175'; '\178'; '\182';
    '\183'; '\184'; '\186'; '\192'; '\193'; '\196'; '\200'; '\204'; '\205';
    '\208'; '\216'; '\218'; '\220'; '\228'; '\229'; '\239'; '\240'; '\241';
    '\242'; '\249'; '\251'; '\253'; '\255'];
   ['\001'; '\003'; '\t'; '\015'; '\017'; '\019'; '\020'; '\025'; '\027';
    '\029'; '\030'; '\031'; '*'; '+'; '.'; '1'; '2'; '4'; '7'; '9'; ':'; ';';
    '?'; 'B'; 'D'; 'H'; 'I'; 'K'; 'P'; 'R'; 'T'; 'W'; ']'; 'a'; 'b'; 'f';
    'g'; 'h'; 'm'; 'p'; 'r'; 's'; 'y'; 'z'; '}'; '\128'; '\129'; '\132';
    '\135'; '\136'; '\143'; '\145'; '\146'; '\147'; '\148'; '\149'; '\153';
    '\155'; '\161'; '\162'; '\164'; '\167'; '\168'; '\171'; '\172'; '\175';
    '\176'; '\177'; '\179'; '\181'; '\185'; '\188'; '\190'; '\191'; '\194';
    '\195'; '\196'; '\197'; '\198'; '\199'; '\201'; '\204'; '\207'; '\211';
    '\214'; '\215'; '\216'; '\217'; '\221'; '\225'; '\227'; '\229'; '\230';
    '\231'; '\233'; '\234'; '\237'; '\238'; '\249'];
   ['\001'; '\002'; '\004'; '\t'; '\014'; '\017'; '\018'; '\019'; '\020';
    '\022'; '\024'; '\026'; '\027'; '\028'; ' '; '!'; '+'; ','; '-'; '/';
    '2'; '3'; '7'; '8'; '9'; ';'; '>'; '@'; 'A'; 'B'; 'E'; 'G'; 'H'; 'I';
    'L'; 'M'; 'P'; 'R'; 'S'; 'T'; 'U'; 'Y'; ']'; 'a'; 'f'; 'h'; 'i'; 'j';
    'l'; 'm'; 't'; 'u'; 'v'; '|'; '}'; '\128'; '\130'; '\131'; '\134';
    '\136'; '\137'; '\139'; '\140'; '\144'; '\150'; '\151'; '\152'; '\154';
    '\155'; '\156'; '\159'; '\161'; '\162'; '\166'; '\168'; '\170'; '\171';
    '\172'; '\175'; '\178'; '\180'; '\182'; '\184'; '\188'; '\189'; '\196';
    '\197'; '\198'; '\199'; '\201'; '\204'; '\206'; '\208'; '\211'; '\213';
    '\214'; '\217'; '\219'; '\223'; '\225'; '\226'; '\227'; '\228'; '\233';
    '\236'; '\237'; '\239'; '\242'; '\244'; '\245'; '\247'; '\248'; '\249';
    '\255'];
   ['\001'; '\003'; '\006'; '\007'; '\t'; '\n'; '\011'; '\r'; '\014'; '\015';
    '\017'; '\019'; '\020'; '\022'; '\023'; '\025'; '\026'; '\027'; '\028';
    '\029'; '\031'; ' '; '!'; '#'; '%'; ')'; '*'; '+'; '-'; '/'; '1'; '2';
    '3'; '4'; '6'; '8'; '9'; ':'; ';'; '>'; '?'; 'C'; 'D'; 'F'; 'H'; 'M';
    'R'; 'T'; 'U'; 'V'; 'Y'; '['; 'a'; 'b'; 'c'; 'f'; 'h'; 'i'; 'm'; 'q';
    't'; 'x'; 'y'; 'z'; '{'; '|'; '}'; '~'; '\130'; '\139'; '\142'; '\148';
    '\152'; '\153'; '\154'; '\159'; '\160'; '\162'; '\164'; '\167'; '\168';
    '\171'; '\176'; '\177'; '\178'; '\181'; '\182'; '\183'; '\186'; '\188';
    '\190'; '\192'; '\193'; '\200'; '\205'; '\206'; '\207'; '\208'; '\212';
    '\213'; '\214'; '\215'; '\218'; '\219'; '\220'; '\221'; '\223'; '\224';
    '\228'; '\229'; '\231'; '\232'; '\233'; '\234'; '\235'; '\236'; '\237';
    '\238'; '\241'; '\242'; '\243'; '\246'; '\247'; '\249'; '\250'; '\251'];
   ['\003'; '\004'; '\006'; '\b'; '\t'; '\n'; '\012'; '\014'; '\015'; '\016';
    '\022'; '\026'; '\027'; '\030'; '!'; '#'; '&'; ')'; '+'; '-'; '.'; '2';
    '3'; '4'; '7'; '8'; '9'; ':'; ';'; '='; '>'; '?'; '@'; 'A'; 'J'; 'K';
    'L'; 'O'; 'Q'; 'R'; 'S'; 'W'; 'Y'; 'Z'; '['; '\\'; ']'; '^'; '`'; 'a';
    'c'; 'd'; 'j'; 'k'; 'l'; 'm'; 'p'; 'r'; 's'; 't'; 'u'; 'v'; 'w'; '|';
    '}'; '\130'; '\131'; '\135'; '\136'; '\137'; '\138'; '\140'; '\142';
    '\145'; '\149'; '\150'; '\151'; '\152'; '\155'; '\160'; '\162'; '\165';
    '\172'; '\175'; '\177'; '\182'; '\184'; '\185'; '\187'; '\189'; '\191';
    '\193'; '\195'; '\196'; '\197'; '\201'; '\202'; '\204'; '\205'; '\206';
    '\207'; '\208'; '\210'; '\211'; '\212'; '\213'; '\223'; '\224'; '\226';
    '\231'; '\232'; '\233'; '\234'; '\236'; '\237'; '\238'; '\243'; '\245';
    '\246'; '\253'];
   ['\000'; '\001'; '\002'; '\005'; '\t'; '\n'; '\r'; '\020'; '\021'; '\023';
    '\024'; '\026'; '\027'; '\028'; '\029'; '\030'; ' '; '#'; '$'; '%'; '&';
    '\''; '('; ')'; ','; '0'; '1'; '2'; '3'; '4'; '5'; '6'; '8'; ';'; '<';
    '='; 'A'; 'F'; 'G'; 'I'; 'J'; 'L'; 'P'; 'R'; 'S'; 'U'; 'V'; 'W'; 'X';
    'Y'; 'Z'; '['; '\\'; ']'; '^'; '_'; 'b'; 'e'; 'h'; 'i'; 'j'; 'k'; 'l';
    'n'; 'u'; 'v'; 'w'; '{'; '|'; '}'; '\127'; '\128'; '\130'; '\131';
    '\133'; '\134'; '\139'; '\141'; '\142'; '\143'; '\144'; '\150'; '\151';
    '\152'; '\153'; '\154'; '\155'; '\158'; '\160'; '\162'; '\165'; '\166';
    '\169'; '\170'; '\171'; '\172'; '\174'; '\176'; '\177'; '\178'; '\179';
    '\183'; '\187'; '\188'; '\189'; '\190'; '\192'; '\194'; '\195'; '\197';
    '\200'; '\202'; '\203'; '\204'; '\207'; '\210'; '\211'; '\213'; '\214';
    '\215'; '\216'; '\217'; '\224'; '\225'; '\230'; '\231'; '\232'; '\233';
    '\241'; '\242'; '\244'; '\247'; '\248'; '\250'; '\252'; '\253'; '\254'];
   ['\001'; '\002'; '\003'; '\004'; '\005'; '\006'; '\007'; '\n'; '\011';
    '\012'; '\016'; '\017'; '\020'; '\025'; '\027'; '\028'; '\029'; '\030';
    '\031'; ' '; '!'; '"'; '$'; '%'; '&'; '\''; '('; ')'; ','; '3'; '4'; '6';
    '8'; ':'; '<'; '>'; 'C'; 'D'; 'E'; 'J'; 'K'; 'L'; 'M'; 'N'; 'P'; 'Q';
    'R'; 'T'; 'U'; 'V'; '['; '\\'; '_'; 'a'; 'd'; 'e'; 'f'; 'g'; 'j'; 'n';
    'o'; 'u'; 'v'; 'w'; '{'; '~'; '\128'; '\129'; '\131'; '\132'; '\133';
    '\137'; '\140'; '\141'; '\143'; '\146'; '\147'; '\148'; '\149'; '\150';
    '\153'; '\154'; '\155'; '\157'; '\158'; '\159'; '\160'; '\165'; '\166';
    '\167'; '\168'; '\171'; '\172'; '\173'; '\175'; '\176'; '\178'; '\180';
    '\182'; '\184'; '\185'; '\188'; '\189'; '\190'; '\196'; '\198'; '\199';
    '\200'; '\201'; '\202'; '\203'; '\205'; '\206'; '\207'; '\210'; '\212';
    '\213'; '\216'; '\217'; '\218'; '\220'; '\221'; '\222'; '\225'; '\226';
    '\229'; '\230'; '\232'; '\233'; '\234'; '\235'; '\236'; '\239'; '\240';
    '\241'; '\242'; '\243'; '\244'; '\246'; '\247'; '\250'; '\251'; '\252';
    '\254'; '\255'];
   ['\000'; '\003'; '\004'; '\n'; '\011'; '\012'; '\014'; '\016'; '\018';
    '\019'; '\020'; '\023'; '\025'; '\027'; '\028'; '\029'; ' '; '!'; '#';
    '$'; '%'; '&'; '\''; ')'; '*'; '+'; ','; '-'; '.'; '/'; '2'; '4'; '5';
    '6'; '8'; ':'; '='; '?'; 'B'; 'C'; 'D'; 'F'; 'G'; 'K'; 'L'; 'O'; 'R';
    'T'; 'X'; 'Y'; '['; 'a'; 'b'; 'c'; 'd'; 'g'; 'h'; 'k'; 'l'; 'm'; 'n';
    'r'; 'u'; 'x'; 'y'; 'z'; '{'; '|'; '}'; '~'; '\127'; '\129'; '\130';
    '\133'; '\134'; '\136'; '\137'; '\140'; '\141'; '\142'; '\143'; '\144';
    '\145'; '\146'; '\147'; '\149'; '\150'; '\151'; '\152'; '\153'; '\162';
    '\163'; '\164'; '\165'; '\167'; '\168'; '\178'; '\179'; '\182'; '\184';
    '\186'; '\187'; '\189'; '\191'; '\192'; '\193'; '\194'; '\198'; '\201';
    '\202'; '\203'; '\204'; '\205'; '\206'; '\207'; '\209'; '\210'; '\211';
    '\212'; '\213'; '\214'; '\216'; '\217'; '\218'; '\219'; '\220'; '\222';
    '\223'; '\225'; '\226'; '\227'; '\230'; '\233'; '\234'; '\236'; '\237';
    '\239'; '\240'; '\243'; '\244'; '\245'; '\246'; '\247'; '\248'; '\249';
    '\250'; '\252'; '\254'; '\255'];
   ['\000'; '\001'; '\003'; '\004'; '\005'; '\t'; '\011'; '\012'; '\016';
    '\019'; '\020'; '\022'; '\024'; '\025'; '\026'; '\027'; '\028'; '\029';
    '\031'; '!'; '"'; '\''; '('; ')'; '+'; '.'; '0'; '1'; '2'; '3'; '6'; '7';
    '9'; ':'; 'A'; 'B'; 'D'; 'E'; 'F'; 'H'; 'J'; 'K'; 'N'; 'O'; 'T'; 'U';
    'V'; 'X'; 'Y'; 'Z'; '['; '\\'; '_'; '`'; 'a'; 'b'; 'c'; 'd'; 'g'; 'h';
    'i'; 'k'; 'l'; 'm'; 'n'; 'o'; 'p'; 'r'; 't'; 'u'; 'v'; 'w'; 'x'; 'y';
    '|'; '}'; '\129'; '\130'; '\131'; '\132'; '\135'; '\136'; '\137'; '\138';
    '\139'; '\141'; '\143'; '\144'; '\146'; '\147'; '\149'; '\152'; '\154';
    '\155'; '\156'; '\158'; '\160'; '\163'; '\164'; '\167'; '\168'; '\169';
    '\170'; '\171'; '\174'; '\175'; '\176'; '\180'; '\181'; '\183'; '\184';
    '\185'; '\186'; '\187'; '\188'; '\189'; '\194'; '\195'; '\196'; '\197';
    '\198'; '\199'; '\200'; '\204'; '\206'; '\207'; '\209'; '\210'; '\211';
    '\212'; '\215'; '\216'; '\218'; '\219'; '\220'; '\221'; '\222'; '\224';
    '\225'; '\226'; '\227'; '\234'; '\235'; '\236'; '\237'; '\242'; '\243';
    '\244'; '\246'; '\248'; '\249'; '\250'; '\251'; '\252'; '\253'; '\255'];
    List.filter (fun c -> 'a' <= c && c <= 'z') (List.init 256 Char.chr);
    List.init 32  (fun x -> Char.chr (x * 8 + 1));
    List.init 32  (fun x -> Char.chr (x * 8));
    List.init 64  (fun x -> Char.chr (x * 4));
    List.init 128 (fun x -> Char.chr (x * 2));
    List.init 256 Char.chr;
  ] 
